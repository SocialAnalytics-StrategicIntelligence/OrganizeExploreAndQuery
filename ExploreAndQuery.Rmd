---
title: "Explore and Query"
output: html_notebook
---
```{r}
rm(list = ls())
denguelink='https://github.com/SocialAnalytics-StrategicIntelligence/OrganizeExploreAndQuery/raw/main/dataFiles/ByYear_stats.pkl'

library(reticulate)
# py_install("pandas")
pd <- import("pandas")
dengueStats <- pd$read_pickle(denguelink)


str(dengueStats) 


```
```{r}
library(ggplot2)
ggplot(data=dengueStats,aes(x=ano,y=edad_mean)) + 
    geom_point() + 
    geom_smooth(aes(color=enfermedad))


```
```{r}
ggplot(data=dengueStats,aes(x=ano,y=edad_median)) + 
    geom_point() + 
    geom_smooth(aes(color=enfermedad))
```

```{r}
ggplot(data=dengueStats,aes(x=ano,y=case_sum)) + 
    geom_point() + 
    geom_smooth(aes(color=enfermedad))
```


```{r}
ggplot(data=dengueStats,aes(x=ano,y=case_sum)) + 
    geom_point() + 
    geom_smooth(aes(color=enfermedad)) + scale_y_log10(labels = scales::comma)
```




```{r}
denguelink2='https://github.com/SocialAnalytics-StrategicIntelligence/OrganizeExploreAndQuery/raw/main/dataFiles/ByYear_LongStats.pkl'

dengueLongStats <- pd$read_pickle(denguelink2)


str(dengueLongStats) 
```
```{r}
ggplot(data=dengueLongStats,
       aes(x=ano,y=statsValue,color=enfermedad))+ theme_light() +
    geom_smooth() + facet_grid(statsName~.,scales = 'free_y') + scale_y_log10(labels=scales::comma)
```

```{r}
ggplot(data=dengueLongStats,
       aes(x=ano,y=statsValue,color=enfermedad))+ theme_light() +
    geom_line() + facet_grid(statsName~.,scales = 'free_y') + scale_y_log10()
```


```{r}
denguelink3='https://github.com/SocialAnalytics-StrategicIntelligence/OrganizeExploreAndQuery/raw/main/dataFiles/worst_ProvYear_alarma_Frequency.csv'

dengueProvWorst <- read.csv(denguelink3)


str(dengueProvWorst) 
```

```{r heatDescending, eval=TRUE}
# default 

baseHeat  = ggplot(dengueProvWorst, aes(x = reorder(departamento,case), y = reorder(provincia,case), fill=case)) + theme_classic()
heatDefault = baseHeat +  geom_tile() #here

heatBetter=heatDefault +scale_fill_gradientn(colours = rev(heat.colors(5)))
heatBetter + theme(axis.text.x = element_text(angle = 60,vjust = 1,hjust = 1),
                   axis.text.y = element_text(size=4)) +
                   geom_text(aes(label=ifelse(case>=10,case,"")),fontface='bold', color='white')


```


```{r}
denguelink4='https://raw.githubusercontent.com/SocialAnalytics-StrategicIntelligence/OrganizeExploreAndQuery/main/dataFiles/ByYearPlace.csv'

dengueYearPlace <- read.csv(denguelink4)

str(dengueYearPlace) 
```


```{r heatDescending2, eval=TRUE}
# default 

baseHeat  = ggplot(dengueYearPlace, aes(x = as.factor(ano),
                                       y =reorder(departamento,
                                                  as.numeric(rateAlarma)), 
                                       fill=rateAlarma.cut)) + theme_classic()
heatDefault = baseHeat +  geom_tile(show.legend = T) #here

heatBetter=heatDefault +scale_fill_brewer(palette = "Reds",direction = -1)
heatBetter + theme(axis.text.x = element_text(angle = 60,vjust = 1,hjust = 1),
                   axis.text.y = element_text(size=4))
```